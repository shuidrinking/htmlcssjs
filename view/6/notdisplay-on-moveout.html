<style type="text/css">
/*右上角放置用户头像的容器*/
.user-op-box-containner {
	height:1rem;
	position:relative;
	width:2rem;
}
/* 右顶部头像按钮点击后，弹出的菜单样式 */
.user-op-box{
	width: 2rem;
	padding: 0.1rem;
	position: absolute;
	top: 0.3rem;
	right: 0.3rem;
	display: none;
	background-color: #ffffff;
	border-radius: 0.04rem;
	box-shadow: 0 0 0.1rem #b9b9b9;
	transition: all 0.5s linear 0s;
	text-align: left;
}
/* 弹出框中的子菜单 */
.useropbox-menuitem{
	height:0.4rem;
	line-height:0.4rem;
	padding: 0 0.1rem;
	width: calc(100% - 0.2rem);
	cursor: pointer;
	transition: all 0.5s linear 0s;
	border-radius: 0.04rem;
	margin:0.05rem 0;
}
.useropbox-menuitem:hover{
	background-color:#f0f0f0;
	transition: all 0.5s linear 0s;
}

/*菜单样式*/
.menu-item{
	width: 1.5rem;
	height: 0.3rem;
	line-height: 0.3rem;
	border-radius:0.04rem;
	padding:0.05rem;
	text-align:left;
	cursor:pointer;
	margin-bottom:0.05rem;
	font-size:0.14rem;
	position:relative;
	transition: all 0.5s linear 0s;
	border:1px solid #e3e3e3;
}
.menu-item>*{
	cursor:pointer;
}
.menu-item:hover{
	background-color: #eeeeee !important;
}
/*鼠标划过时，其内部的class为page-setting-button的元素改变显示*/
.menu-item:hover .page-setting-button{
	display:unset;
	transition: all 0.5s linear 0s;
}
.page-setting-button{
	float:right;
	margin-top:0.08rem;
	display:none;
	line-height: 1;
	text-align:center;
	cursor: pointer;
	vertical-align:middle;
	transition: all 0.5s linear 0s;
	font-family:shuidrinking;
}
.page-setting-button:before {
	content: "\e918";
}
.user-op-icon{
	font-family:shuidrinking;
	margin-left:0.1rem;
}
</style>

<script type="text/javascript">
	function popupPageSettingMenu(_source) {
		$('user-op-box').style.display = 'none';
		let computedStyle=_source.getBoundingClientRect();
		$('user-op-box').style.left = _source.offsetLeft + _source.offsetWidth + "px";
		$('user-op-box').style.top = _source.offsetTop + _source.offsetHeight  + "px";
		/* 
		//如果要用下面这段，这个弹出框的父元素必须是body
		$('user-op-box').style.right = window.event.clientX + "px";
		$('user-op-box').style.top = window.event.clientY + "px"; 
		*/
		console.info($('user-op-box').style.right);
		//console.info($('user-op-box').style.top);
		$('user-op-box').style.display = 'block';
	}
	//判定鼠标是否挪出了弹出框，如果挪出后隐藏
	function isMoveOut(_source) {
		
		let computedStyle=_source.getBoundingClientRect();
		/**
		返回值是一个 DOMRect 对象，是包含整个元素的最小矩形（包括 padding 和 border-width）。
		该对象使用 left、top、right、bottom、x、y、width 和 height 这几个以像素为单位的只读属性描述整个矩形的位置和大小。
		除了 width 和 height 以外的属性是相对于视图窗口的左上角来计算的。
		_element.getBoundingClientRect()={
		x及left:最左边的x
		y及top:顶部的y
		bottom:底部的y
		right:最右边的x
		width:当前宽度
		height:当前高度
		}
		*/
		if(event.clientX < computedStyle.x || event.clientX > computedStyle.right){
			_source.style.display= "none";
		}
		if(event.clientY < computedStyle.y || event.clientY > computedStyle.bottom){
			_source.style.display= "none";
		}
	}
</script>
<pre class="prettyprint lang-javascript">
弹出框的触发机制：
（1）弹出框本身是一个绝对定位的组件，如果是flex，则其parent必须是<div class="mui-content">
（2）弹出框显示时，当其position:flex时，可以设置其left和top与event.X和eventY一致，如果是absolute时，必须考虑其parent，可以根据使用场景设置以left或者right作为水平坐标参数
</div>
</pre>
<pre class="prettyprint lang-javascript">
为弹出框设置onmouseout监听函数，监听弹出框的鼠标划动事件
函数中判定是否划出的算法：
（1）获取弹出框的最小x，最大x，最小y，最大y
（2）判断鼠标的坐标，如果 “最小x&lt;=鼠标x&lt;=最大x 且 最小y&lt;=鼠标y&lt;=最大y”，则在框内，否则已经划出框外
函数实现本身非常简单，如下：
function isMoveOut(_source) {
	let computedStyle=_source.getBoundingClientRect();
	if(event.clientX < computedStyle.x || event.clientX > computedStyle.right){
		_source.style.display= "none";
	}
	if(event.clientY < computedStyle.y || event.clientY > computedStyle.bottom){
		_source.style.display= "none";
	}
}
</pre>

<div class="demobox">
	<div class="user-op-box-containner">
		<div class="menu-item">
			<label>办公用品申请</label>
			<label class="page-setting-button" onclick="popupPageSettingMenu(this)"></label>
			<!-- 弹出菜单div，绝对定位 -->
			<div id="user-op-box" class="user-op-box" onmouseout="isMoveOut(this)">
				<div class="useropbox-menuitem">操作一<label class="user-op-icon">&#xe91f;</label></div>
				<div class="useropbox-menuitem">操作二<label class="user-op-icon">&#xe918;</label></div>
			</div>
		</div>
		<div class="button deepBlueButton" onclick="popupPageSettingMenu(this)">弹出</div>
	</div>
</div>